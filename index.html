<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
    <title>Todo Reminders</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --primary: #4a90e2; 
            --bg: #181a1b; 
            --card: #232526; 
            --text: #e8e6e3;
            --text-secondary: #a8a095;
            --border: #3d4042;
            --hover: #2d2f31;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            line-height: 1.6;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 1.5rem; 
            width: 100%;
        }
        
        /* Responsive breakpoints */
        @media screen and (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
                padding: 0.5rem 0;
            }
            
            .hero {
                padding: 1rem 0;
                min-height: auto;
                margin-top: 1rem;
            }
            
            h1 {
                font-size: 2rem;
                margin-bottom: 1rem;
            }
            
            .lead {
                font-size: 1.1rem;
                margin-bottom: 2rem;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
                gap: 0.75rem;
            }
            
            .btn {
                width: 100%;
                max-width: 280px;
                padding: 0.75rem 1.25rem;
            }
            
            .modal-content {
                width: 90%;
                margin: 10% auto;
                padding: 1.5rem;
            }
            
            .form-group {
                margin-bottom: 1rem;
            }
        }
        
        @media screen and (max-width: 480px) {
            h1 {
                font-size: 1.75rem;
            }
            
            .lead {
                font-size: 1rem;
            }
            
            .modal-content {
                width: 95%;
                margin: 20% auto;
                padding: 1.25rem;
            }
            
            .form-actions {
                flex-direction: column;
                gap: 0.75rem;
            }
            
            .form-actions .btn {
                width: 100%;
                margin: 0;
            }
        }
        header { 
            background: var(--card); 
            border-bottom: 1px solid var(--border);
            padding: 1rem 0; 
        }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { 
            font-size: 1.5rem; 
            font-weight: 700; 
            color: var(--primary); 
            text-decoration: none; 
            letter-spacing: 0.5px;
        }
        .btn { 
            padding: 0.5rem 1.25rem; 
            border-radius: 8px; 
            font-weight: 500; 
            cursor: pointer; 
            transition: all 0.2s;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        .btn-primary { 
            background: var(--primary); 
            color: white; 
            border: none; 
        }
        .btn-outline { 
            background: transparent; 
            border: 1px solid var(--border); 
            color: var(--text);
        }
        .btn:hover { 
            opacity: 0.9;
            transform: translateY(-1px);
        }
        .hero { 
            min-height: calc(100vh - 73px); 
            display: flex; 
            align-items: center; 
            padding: 2rem 0; 
            background: var(--bg);
        }
        .hero-content { 
            text-align: center; 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 2rem 0;
        }
        h1 { 
            font-size: 2.5rem; 
            font-weight: 700; 
            margin-bottom: 1.5rem; 
            color: var(--primary);
            letter-spacing: 0.5px;
        }
        .lead { 
            font-size: 1.25rem; 
            color: var(--text-secondary); 
            margin-bottom: 2.5rem;
            line-height: 1.6;
        }
        .cta-buttons { 
            display: flex; 
            gap: 1rem; 
            justify-content: center; 
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }
        .modal { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            background: rgba(0,0,0,0.7); 
            z-index: 1000; 
            align-items: center; 
            justify-content: center; 
        }
        .modal-content { 
            background: var(--card); 
            padding: 2rem; 
            border-radius: 12px; 
            width: 100%; 
            max-width: 400px; 
            position: relative; 
            margin: 10% auto;
            max-height: 90vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        .close { 
            position: absolute; 
            top: 1rem; 
            right: 1rem; 
            font-size: 1.5rem; 
            cursor: pointer; 
            color: var(--text-secondary);
            background: none;
            border: none;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
        }
        .close:hover {
            background: var(--hover);
        }
        .form-group { margin-bottom: 1.25rem; }
        .form-group label { 
            display: block; 
            margin-bottom: 0.5rem; 
            font-weight: 500; 
            color: var(--text);
        }
        .form-control { 
            width: 100%; 
            padding: 0.75rem 1rem; 
            border: 1px solid var(--border); 
            border-radius: 8px; 
            background: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Arial, sans-serif;
            font-size: 0.95rem;
        }
        .form-control:focus { 
            outline: none; 
            border-color: var(--primary); 
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2); 
        }
        .auth-footer { 
            text-align: center; 
            margin-top: 1.5rem; 
            color: var(--text-secondary); 
            font-size: 0.95rem;
        }
        .auth-toggle { 
            color: var(--primary); 
            cursor: pointer; 
            font-weight: 500; 
            text-decoration: none;
            transition: opacity 0.2s;
        }
        .auth-toggle:hover {
            text-decoration: underline;
            opacity: 0.9;
        }
        .alert { 
            padding: 0.875rem 1rem; 
            border-radius: 8px; 
            margin-bottom: 1.25rem; 
            display: none;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        .alert-error { 
            background: rgba(220, 38, 38, 0.1); 
            color: #f87171; 
            border: 1px solid rgba(220, 38, 38, 0.2);
        }
        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .cta-buttons { flex-direction: column; }
            .btn { width: 100%; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <h1 class="logo" style="margin: 0; font-size: 1.5rem; font-weight: 700; color: var(--primary);">Taskhub</h1>
                <div>
                    <button id="login-btn" class="btn btn-outline">Log in</button>
                    <button id="register-btn" class="btn btn-primary">Sign up</button>
                </div>
            </div>
        </div>
    </header>

    <main class="hero">
        <div class="container">
            <div class="hero-content">
                <h1>Take control of your tasks</h1>
                <p class="lead" style="white-space: nowrap;">Stay organized and on top of your tasks with our intuitive TODO Lists, Reminders, and Calendar.</p>
                
                <div class="cta-buttons">
                    <button id="cta-register" class="btn btn-primary">Get Started for Free</button>
                    <button id="cta-login" class="btn btn-outline">I already have an account</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Auth Modals -->
    <div id="auth-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            
            <!-- Login Form -->
            <form id="login" class="auth-form">
                <h2>Welcome back</h2>
                <div id="login-error" class="alert alert-error">
                    Invalid email or password
                </div>
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary">Sign in</button>
                <div class="auth-footer">
                    Don't have an account? <a href="#" class="auth-toggle" id="show-register">Sign up</a>
                </div>
            </form>

            <!-- Register Form -->
            <form id="register" style="display: none;">
                <h2>Create an account</h2>
                <div id="register-error" class="alert alert-error">
                    Error creating account
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="register-password">Password</label>
                    <input type="password" id="register-password" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="confirm-password">Confirm Password</label>
                    <input type="password" id="confirm-password" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary">Create account</button>
                <div class="auth-footer">
                    Already have an account? <a href="#" class="auth-toggle" id="show-login">Sign in</a>
                </div>
            </form>
        </div>
    </div>

    <script type="module">
        import { signIn, signUp, isAuthenticated } from './js/auth.js';

        // Wait for the DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', async () => {
            // Redirect if already authenticated
            const authenticated = await isAuthenticated();
            if (authenticated) {
                window.location.href = 'reminders.html';
                return;
            }

            // DOM Elements
            const authModal = document.getElementById('auth-modal');
            const loginForm = document.getElementById('login');
            const registerForm = document.getElementById('register');
            const loginBtn = document.getElementById('login-btn');
            const registerBtn = document.getElementById('register-btn');
            const ctaLogin = document.getElementById('cta-login');
            const ctaRegister = document.getElementById('cta-register');
            const closeBtn = document.querySelector('.close');
            const showRegister = document.getElementById('show-register');
            const showLogin = document.getElementById('show-login');

            // Show login form
            function showLoginForm(e) {
                if (e) e.preventDefault();
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
                authModal.style.display = 'flex';
                document.querySelectorAll('.alert').forEach(alert => alert.style.display = 'none');
            }

            // Show register form
            function showRegisterForm(e) {
                if (e) e.preventDefault();
                registerForm.style.display = 'block';
                loginForm.style.display = 'none';
                authModal.style.display = 'flex';
                document.querySelectorAll('.alert').forEach(alert => alert.style.display = 'none');
            }

            // Close modal
            function closeModal(e) {
                if (e) e.preventDefault();
                authModal.style.display = 'none';
                loginForm.reset();
                registerForm.reset();
            }

            // Event Listeners
            if (loginBtn) loginBtn.addEventListener('click', showLoginForm);
            if (registerBtn) registerBtn.addEventListener('click', showRegisterForm);
            if (ctaLogin) ctaLogin.addEventListener('click', showLoginForm);
            if (ctaRegister) ctaRegister.addEventListener('click', showRegisterForm);
            if (closeBtn) closeBtn.addEventListener('click', closeModal);
            if (showRegister) showRegister.addEventListener('click', showRegisterForm);
            if (showLogin) showLogin.addEventListener('click', showLoginForm);

            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === authModal) closeModal();
            });

            // Handle login form submission
            if (loginForm) {
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('login-email').value;
                    const password = document.getElementById('login-password').value;
                    const errorElement = document.getElementById('login-error');

                    try {
                        const { user, error } = await signIn(email, password);
                        if (error) throw error;
                        window.location.href = 'reminders.html';
                    } catch (error) {
                        console.error('Login error:', error);
                        errorElement.textContent = error.message || 'Failed to sign in. Please try again.';
                        errorElement.style.display = 'block';
                    }
                });
            }

            // Handle registration form submission
            if (registerForm) {
                registerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('register-email').value;
                    const password = document.getElementById('register-password').value;
                    const confirmPassword = document.getElementById('confirm-password').value;
                    const errorElement = document.getElementById('register-error');

                    // Validate passwords match
                    if (password !== confirmPassword) {
                        errorElement.textContent = 'Passwords do not match';
                        errorElement.style.display = 'block';
                        return;
                    }

                    if (password.length < 6) {
                        errorElement.textContent = 'Password must be at least 6 characters';
                        errorElement.style.display = 'block';
                        return;
                    }

                    try {
                        const { user, error } = await signUp(email, password);
                        if (error) throw error;
                        
                        // After successful registration, show success message and switch to login
                        registerForm.reset();
                        showLoginForm();
                        
                        // Show success message
                        const loginSuccess = document.createElement('div');
                        loginSuccess.className = 'alert';
                        loginSuccess.style.background = 'rgba(16, 185, 129, 0.1)';
                        loginSuccess.style.color = '#10b981';
                        loginSuccess.style.border = '1px solid rgba(16, 185, 129, 0.2)';
                        loginSuccess.textContent = 'Registration successful! Please check your email to verify your account.';
                        loginForm.insertBefore(loginSuccess, loginForm.firstChild);
                        loginSuccess.style.display = 'block';
                    } catch (error) {
                        console.error('Registration error:', error);
                        errorElement.textContent = error.message || 'Failed to create account. Please try again.';
                        errorElement.style.display = 'block';
                    }
                });
            }
        });
    </script>
</body>
</html>